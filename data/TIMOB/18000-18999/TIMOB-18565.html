---
title: "[TIMOB-18565] Android: Support android *.aar libraries while building module"
---
<table>
<tr><th>GitHub Issue</th><td>n/a</td></tr>
<tr><th>Type</th><td>New Feature</td></tr>
<tr><th>Priority</th><td>Critical</td></tr>
<tr><th>Status</th><td>Closed</td></tr>
<tr><th>Resolution</th><td>Fixed</td></tr>
<tr><th>Resolution Date</th><td>2017-03-27T15:05:55.000+0000</td></tr>
<tr><th>Affected Version/s</th><td>n/a</td></tr>
<tr><th>Fix Version/s</th><td>Release 6.1.0</td></tr>
<tr><th>Components</th><td>Android, Tooling</td></tr>
<tr><th>Labels</th><td>aar, android, library, merge-6.1.0, module</td></tr>
<tr><th>Reporter</th><td>Far</td></tr>
<tr><th>Assignee</th><td>Jan Vennemann</td></tr>
<tr><th>Created</th><td>2015-02-12T16:44:02.000+0000</td></tr>
<tr><th>Updated</th><td>2017-06-21T13:42:33.000+0000</td></tr>
</table>

<h3>Description</h3>

It will be nice to support android *.aar libraries while building module

<h3>Comments</h3>

<ol>
<li>Chee Kiat Ng 2015-10-27

   </li>
<li>Rakhi Mitro 2016-03-07

   Thanks [~msamah]</li>
<li>Michael Gangolf 2016-06-08

   Any update on this issue?</li>
<li>Carlos Henrique Zinato 2016-06-08

   would be so cool to have it</li>
<li>Francisco Antonio Duran Ramirez 2016-06-10

   Hello Chee Kiat Ng. Good afternoon. 
   
   Any news on this?
   
   Thanks, and best,
   Antonio</li>
<li>Peter Steinberger 2016-11-09

   This is currently a hard blocker for writing an Android wrapper for <a href="https://pspdfkit.com." rel="nofollow" target="_blank">https://pspdfkit.com.</a> 
   We managed to write Android wrappers for Xamarin, Cordova and ReactNative, however we can't write one for Titanium without this blocker being resolved.
   
   Is there any update or ETA on this ticket?
   
   Can you give us more information on TIMOB-19300? It's not accessible.</li>
<li>Ingo Muschenetz 2016-11-28

   [~cng] could you please take a look here?</li>
<li>Rodolfo Perottoni 2017-01-05

   Nothing ?</li>
<li>Hans Knöchel 2017-01-05

   [~rdperottoni] As you can see, this ticket is assigned and currently in progress.</li>
<li>Jan Vennemann 2017-02-07

    PR: <a href="https://github.com/appcelerator/titanium_mobile/pull/8792" rel="nofollow" target="_blank">https://github.com/appcelerator/titanium_mobile/pull/8792</a></li>
<li>Muhammad Ahmed Fahad 2017-02-13

    Once reviewed, would it be possible to get this back-ported to the '5_5_X' branch or '6_0_X' branch?</li>
<li>Eric Merriman  2017-02-27

    [~farwayer] Do you have a specific aar library you'd like us to incorporate in our testing of this?
    
    If not, we will use others, but it would be ideal to have the one(s) you will be using. Thanks.</li>
<li>Peter Steinberger 2017-02-27

    Eric, if you don't already have a sample I'd love to work with you to try this on PSPDFKit for Android.
    
    We have quite a complex SDK with native parts (for the PDF rendering) and multiple dependencies (e.g. RxJava) so it would be a great test:
    <a href="https://pspdfkit.com/guides/android/current/getting-started/integrating-pspdfkit/" rel="nofollow" target="_blank">https://pspdfkit.com/guides/android/current/getting-started/integrating-pspdfkit/</a>
    
    You can download a demo here:
    <a href="https://pspdfkit.com/#trynow" rel="nofollow" target="_blank">https://pspdfkit.com/#trynow</a>
    
    We have a wrapper for iOS now for many years and this is a blocker for our Android-wrapper.
    <a href="https://pspdfkit.com/guides/android/current/other-languages/appcelerator-titanium/" rel="nofollow" target="_blank">https://pspdfkit.com/guides/android/current/other-languages/appcelerator-titanium/</a>
    
    We have a few customers interested in this and would love to deliver this as soon as this patch ships.</li>
<li>Jan Vennemann 2017-03-01

    [~steipete], thanks for your help! I was able to setup and build a test module but unfortunately the most recent release is incompatible with our SDK because of differences in the targeted SDK version. Would you mind sending me version 2.7 of PSPDFKit which seems to be targeted for the same Android SDK (Marshmallow)? The demo i downloaded only contains PSPDFKit 2.9.</li>
<li>Peter Steinberger 2017-03-01

    </li>
<li>Jan Vennemann 2017-03-02

    [~peterst], i sent you a mail and created TIMOB-24446 based on your feedback and concerns about the Support Libs. [~emerriman] should know more about any update plans for Android N.</li>
<li>Muhammad Ahmed Fahad 2017-03-07

    Anymore progress in the review?</li>
<li>Peter Steinberger 2017-03-07

    Jan is currently in the process of trying a wrapper for our aar with an older version. PSPDFKit is a big project with many dependencies and a native core - if it works for us, it will work for any aar library.
    
    I pinged Eric and N support (API 25) is also actively being worked on. Both should make it into the 6.1.0 release.
    
    There's no release date set for 6.1.0 but based on the issue tracker this seems around 80% done.</li>
<li>Muhammad Ahmed Fahad 2017-03-07

    Thanks @Peter Steinberger, looking forward to testing the built master distribution once this PR is merged :)</li>
<li>Jan Vennemann 2017-03-07

    Quick update from me: As Peter said, i'm currently testing the AAR support with PSPDFKit. Found a few issues in the current implementation, specifically with R class generation and working on fixing those.</li>
<li>Jan Vennemann 2017-03-23

    [~gmathews], updated the PR, please feel free to review now!</li>
<li>Muhammad Ahmed Fahad 2017-03-28

    Gary Mathews, curious, when can we expect this to be merged?</li>
<li>Brandon Fuller 2017-04-02

    I pulled this branch and tried it with an AAR file from Intercom:
    
    <a href="https://github.com/intercom/intercom-android" rel="nofollow" target="_blank">https://github.com/intercom/intercom-android</a>
    
    Fails in a few places.  It cannot properly unzip the AAR right off the bat.  I hacked in a fix there but then it can't generate the R class either.</li>
<li>Jan Vennemann 2017-04-04

    [~brandonfuller], thank's for your feedback. The npm module used to extract the AAR files does seem to have problem with the Intercom library. I'll check that and look for alternatives.
    
    The R class generation error is most likely caused by missing dependencies or mismatching versions of the Intercom library and our bundled support library version. You can take a look at their [Dependency Graph](<a href="https://github.com/intercom/intercom-android#dependency-graph)" rel="nofollow" target="_blank">https://github.com/intercom/intercom-android#dependency-graph)</a> to see which libraries you'll have to drop into your module. As you can see there, they also have a transitive dependency on the support library version 25+ but our bundled support library version is currently locked to 23.4.0 in 6.1.0, which is missing some resource identifiers the Intercom SDK uses. We are evaluating possible fixes for that issue in TIMOB-24446. Until that is solved you have to resort to the 1.x versions of the Intercom SDK which are targeted for API Level 23. It may work with an older 3.x release, but i haven't had the time to test all of them.</li>
<li>Peter Steinberger 2017-04-04

    The Android Support Library mismatch is a problem. I've commented on TIMOB-24446 - that's a blocker for making PSPDFKit for Android on Titanium possible.</li>
<li>Brandon Fuller 2017-04-05

    </li>
<li>Matias Penela 2017-04-05

    Hi Brandon, 
    
    I've commented on my experience regarding the issues you are having here:
    
    <a href="https://github.com/intercom/intercom-android/issues/330" rel="nofollow" target="_blank">https://github.com/intercom/intercom-android/issues/330</a>
    
    At this point I am not sure it is a Appcelerator/Hyperloop issue or more of an Intercom or just plain old library dependency issue. 
    
    I'll chime in if I get past the new set of errors I am getting.
    
    
    </li>
<li>Brandon Fuller 2017-04-05

    </li>
<li>Jan Vennemann 2017-05-10

    [~lchoudhary], steps to test these changes:
    
    1. Create a new module
    2. Download <code>shimmer-release.aar</code> from <a href="https://github.com/facebook/shimmer-android/releases/tag/0.1.0" rel="nofollow" target="_blank">https://github.com/facebook/shimmer-android/releases/tag/0.1.0</a> and place it inside the <code>android/lib</code> folder.
    3. Add the following import to your module's <code>ExampleProxy.java</code>
    <code><pre>
    import android.app.Activity;
    import android.graphics.Color;
    import android.view.Gravity;
    import android.view.ViewGroup.LayoutParams;
    import android.widget.TextView;
    import com.facebook.shimmer.ShimmerFrameLayout;
    </pre></code>
    4. Replace the content of the <code>ExampleView</code> constructor in your module's <code>ExampleProxy.java</code> with the following:
    <code><pre>
    super(proxy);
    
    Activity activity = proxy.getActivity();
    TextView textView = new TextView(activity);
    textView.setText("Awesome new feature!");
    textView.setTextSize(32);
    textView.setTextColor(Color.parseColor("#FFFFFF"));
    ShimmerFrameLayout shimmer = new ShimmerFrameLayout(activity);
    shimmer.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
    shimmer.setDuration(1000);
    shimmer.addView(textView);
    shimmer.startShimmerAnimation();
    setNativeView(shimmer);
    </pre></code>
    5. Build the module, create a new app and add the module to that app.
    6. Replace the content of your app's <code>views/index.xml</code> with the following:
    <code><pre>
    &lt;Alloy&gt;
    	&lt;Window title="Shimmer" backgroundColor="#232E3F"&gt;
    		&lt;View class="vbox" id="shimmerContainer"&gt;&lt;/View&gt;
    	&lt;/Window&gt;
    &lt;/Alloy&gt;
    </pre></code>
    7. Replace the content of your app's <code>controllers/index.js</code> with the following:
    <code><pre>
    var mod = require('&lt;your.module.id&gt;');
    $.shimmerContainer.add(mod.createExample());
    
    $.index.open();
    </pre></code>
    8. Run the app. You should see the text "Awesome new feature!" with a shimmering effect applied to it.</li>
<li>Lokesh Choudhary 2017-05-16

    Verified the fix.
    
    We can successfully add <code>.aar</code> libraries to the modules & access the classes as well.
    Closing.
    
    Studio Ver:     4.9.0.201705110256
    SDK Ver:        6.1.0.v20170516134946
    OS Ver:         10.12.3
    Xcode Ver:      Xcode 8.3.2
    Appc NPM:       4.2.9
    Appc CLI:       6.2.1
    Ti CLI Ver:     5.0.13
    Alloy Ver:      1.9.11
    Node Ver:       6.10.1
    Java Ver:       1.8.0_101
    Devices:        ⇨ oneplus A0001 --- Android 6.0.1</li>
<li> Ricardo Ramirez 2017-05-16

    Awwwesome ! 
    
    Do you have any available url to download the module and test this fix ?</li>
</ol>


<p><a href="/TIMOB/TIMOB-18565.json">JSON Source</a></p>